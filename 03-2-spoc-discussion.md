# 03-2-spoc-discussion

计44 黄锐皓 2014011385

## 思考题

### 6.1	非连续内存分配的需求背景

1. 为什么要设计非连续内存分配机制？

提高分配的灵活性，提高内存的利用效率：方便共享、充分利用内存空间。

2. 非连续内存分配中内存分块大小有哪些可能的选择？大小与大小是否可变?

大块好管理，小块更灵活。

3. 为什么在大块时要设计大小可变，而在小块时要设计成固定大小？小块时的固定大小可以提供多种选择吗？

大块时，固定大小好管理，多种大小比一种大小灵活。

小块时，可变大小更灵活，通常可变大小也会通过对齐来减少管理难度。

## 6.2	段式存储管理

1. 什么是段、段基址和段内偏移？

每个进程由不同的段组成（代码段、数据段、堆栈等），这使得空间的管理更为精细以及高颗粒度化。不同的段内部是连续的，之间不一定连续。段基址是每个段在内存中起始地址。段内偏移是相对于起始地址的偏移量。

2. 段式存储管理机制的地址转换流程是什么？为什么在段式存储管理中，各段的存储位置可以不连续？这种做法有什么好处和麻烦？


地址由段号+逻辑偏移（s+addr）组成，查询段表得到段号对应的段基址，然后加上偏移量得到physical address。
因为各段之间关联不大，很少跨越访问。
好处：可以实现分离管理，并且可以实现方便的共享。
不方便：寻址方法更复杂。

## 6.3	页式存储管理

1. 什么是页（page）、帧（frame）、页表（page table）、存储管理单元（MMU）、快表（TLB, Translation Lookaside Buffer）和高速缓存（cache）？

页是访问方式和存储数据等属性相同的一段更小的逻辑地址空间，帧则是与页相同的物理地址空间，页表是存储页的信息的表，MMU是负责将逻辑地址映射为物理地址的单元，快表是存放在高速缓存中的页表的子集，高速缓存是位于CPU和主存之间的存储器，存有内存数据的子集。

2. 页式存储管理机制的地址转换流程是什么？为什么在页式存储管理中，各页的存储位置可以不连续？这种做法有什么好处和麻烦？

地址为页号加页内偏移。

CPU使用连续的逻辑地址，存储访问时，逻辑地址先分成逻辑页号和页内偏移，然后通过页表的对应关系，把逻辑页面转换成物理页帧，最后再把物理页号加页内偏移得到物理地址，所以可以不连续。

好处是，方便内存管理中的存储分配和回收；麻烦是地址转换比较复杂，并且频繁进行。

## 6.4	页表概述

1. 每个页表项有些什么内容？有哪些标志位？它们起什么作用？

帧号，标志位。

有存在位，修改位，引用位。

2. 页表大小受哪些因素影响？

页的数目、页表项的大小。

## 6.5	快表和多级页表

1. 快表（TLB）与高速缓存（cache）有什么不同？

快表是对页表的缓存，而高速缓存是对进程运行的内存进行缓存。

2. 为什么快表中查找物理地址的速度非常快？它是如何实现的？为什么它的的容量很小？

因为块表的硬件是基于SRAM的cache，存储介质访问速度更快。快表通过将最近访问到的一部分页表内容从主存中加载到cache中，使得在需要访问这些已经被缓存的页表项时不需要访问主存而可以直接在cache中获得需要的页表项。快表的容量限制主要是来自于对功耗和价格的考虑。

3. 什么是多级页表？多级页表中的地址转换流程是什么？多级页表有什么好处和麻烦？

多级页表是对一级列表进一步分块索引存储，形成更多层次的物理地址查询结构。多级页表的地址转换首先根据虚拟地址的较高位页索引在高级页表查找到对应下一级页表的物理地址，再到下一级页表中依据虚拟地址中的索引查找，直到确定最终的物理页的物理地址。多级页表减少了存储页表所需要的存储空间，但是增加了地址转换的复杂度。

## 6.6	反置页表

1. 页寄存器机制的地址转换流程是什么？

逻辑地址进行hash，然后查相应页寄存器。

2. 反置页表机制的地址转换流程是什么？

逻辑地址和进程号共同进行hash，然后查相应页寄存器。

3. 反置页表项有些什么内容？

PID、逻辑页号、标志位。

## 6.7	段页式存储管理

1. 段页式存储管理机制的地址转换流程是什么？这种做法有什么好处和麻烦？

逻辑地址根据段寄存器中的内容选择到GDT或LDT中对应的段表中查询虚拟地址所对应的段的基址。查询过程中需要进行地址是否越界的检查。根据段基址和逻辑地址中的段内偏移对段进行访问。这种做法增强了对内存的保护，防止越权访问以及进程对不属于自身的存储空间访问。麻烦是增加了地址转换的复杂度。

2. 如何实现基于段式存储管理的内存共享？

将要共享的部分的段基址设为相同。

3. 如何实现基于页式存储管理的内存共享？

可以将不同的虚拟地址映射到同一物理地址，采用换出的方式来实现内存的共享。